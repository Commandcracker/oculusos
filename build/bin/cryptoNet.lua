local function a()print("Usage: cryptoNet signCert <file>")print("       cryptoNet demo <server/client>")end;cryptoNet.setLoggingEnabled(true)local b={...}if b[1]=="signCert"then local c=b[2]if c==nil then a()return end;c=workingDir==""and c or shell.dir().."/"..c;local d=b[3]local e,f=pcall(cryptoNet.signCertificate,c,d)if not e then cryptoNet.log("Error: "..f:sub(8))end elseif b[1]=="initCertAuth"then local e,f=pcall(cryptoNet.initCertificateAuthority,b[2],b[3])if not e then cryptoNet.log("Error: "..f:sub(8))end elseif b[1]=="demo"then local g=b[2]if g==nil then a()return end;if g=="server"then function onStart()cryptoNet.host("DemoServer")end;function onEvent(h)if h[1]=="connection_opened"then local i=h[2]cryptoNet.send(i,"Welcome to the server!")cryptoNet.send(i,"Please wait while I show off CryptoNet...")os.sleep(5)cryptoNet.send(i,"Done!")elseif h[1]=="encrypted_message"then if term.isColor()then term.write('[')term.setTextColour(colors.lime)term.write('Client')term.setTextColour(colors.white)print('] '..h[2])else print("[Client] "..h[2])end end end;cryptoNet.startEventLoop(onStart,onEvent)elseif g=="client"then function onStart()local i=cryptoNet.connect("DemoServer")cryptoNet.send(i,"Hello server!")end;function onEvent(h)if h[1]=="encrypted_message"then if term.isColor()then term.write('[')term.setTextColour(colors.red)term.write('Server')term.setTextColour(colors.white)print('] '..h[2])else print("[Server] "..h[2])end end end;cryptoNet.startEventLoop(onStart,onEvent)else a()end else a()end