local a={...}local b,c=term.getSize()local function d(e)for f,g in ipairs(rs.getSides())do if peripheral.getType(g)=="modem"then local h=peripheral.wrap(g)h.closeAll()h.open(e)end end end;local function i(e,j,k)print("Transmitting Message")for f,g in ipairs(rs.getSides())do if peripheral.getType(g)=="modem"then local h=peripheral.wrap(g)h.transmit(e,j,k)end end;sleep(1)end;local function l(m,n,o,k,p)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColour(colors.red)end;print("Side: "..m)if term.isColor()then term.setTextColour(colors.blue)end;print("Frequency: "..n)print("Reply frequency: "..o)print("Distance: "..p)if term.isColor()then term.setTextColour(colors.orange)end;print("Message: "..textutils.serialize(k))end;local function q(r,s)local t=1;local u=false;while true do if term.isColor()then term.setBackgroundColor(colors.blue)else term.setBackgroundColor(colors.gray)end;term.clear()oculusos.printCentred(2,s)for v in ipairs(r)do term.setCursorPos(4,5+v)term.write(" "..r[v])end;term.setCursorPos(4,t+5)term.write("*")paintutils.drawBox(2,4,b-1,7+#r,colors.white)local w,x=os.pullEvent()if w=="key"then if x==200 then u=true;t=t-1;if t==0 then t=#r end elseif x==208 then u=true;t=t+1;if#r<t then t=1 end elseif x==28 then return t end end end end;local y;if#a>0 then y=tonumber(a[1])else y=65533 end;d(y)term.clear()term.setCursorPos(1,1)sniffed={}local function z()while true do local w,g,A,B,C,D=os.pullEvent()if w=="mouse_click"or w=="key"or w=="paste"or w=="char"then break elseif w=="modem_message"then l(g,A,B,C,D)table.insert(sniffed,{["Side"]=g,["Frequency"]=A,["ReplyFrequency"]=B,["Message"]=C,["Distance"]=D})end end end;z()local t=1;local function E()while true do l(sniffed[t]["Side"],sniffed[t]["Frequency"],sniffed[t]["ReplyFrequency"],sniffed[t]["Message"],sniffed[t]["Distance"])if term.isColor()then term.setTextColour(colors.lime)end;print(t.."/"..#sniffed)local w,x=os.pullEvent("key")if x==keys.left then t=t-1;if t==0 then t=#sniffed end elseif x==keys.right then t=t+1;if#sniffed<t then t=1 end elseif x==keys.enter then break end end end;E()local function F()term.setTextColour(colors.white)task=q({"----","Repet","Exit","Sniff","Back"},"Select")if term.isColor()then term.setBackgroundColor(colors.black)end;term.clear()term.setCursorPos(1,1)if task==1 then print(task)elseif task==2 then term.clear()term.setCursorPos(1,1)i(sniffed[t]["Frequency"],sniffed[t]["ReplyFrequency"],sniffed[t]["Message"])F()elseif task==3 then return elseif task==4 then z()E()F()elseif task==5 then E()F()end end;F()