local function a(b)if a==nil then else term.write(a.."? [Y/n] ")end;local c=string.lower(string.sub(read(),1,1))if c=="y"or c=="j"or c==""then return true else return false end end;local function d(e,f)print(e)if string.find(e,".crypt")then print("is already encrypted")if not a("Continue")then return end end;local g=io.open(e,"r")local h=g:read()local i=fs.open(shell.resolve(e..".crypt"),"w")while h do i.flush()g:flush()os.queueEvent("randomEvent")os.pullEvent()if h==nil or h:match("%S")==nil then i.writeLine()else local j=aes.encrypt(f,h,aes.AES256,aes.CBCMODE)if j then i.writeLine(base64.encode(j))else printError("Incorrect password!")return end end;h=g:read()end;i.close()g:close()fs.delete(e)end;local function k(l,f)if fs.isDir(l)then for m,n in pairs(fs.list(l))do local o=l..'/'..n;if fs.isDir(o)then k(o,f)else d(o,f)end end else d(l,f)end end;local p={...}if#p<2 then print("Usage: encrypt <path> <passwd>")return end;k(shell.resolve(p[1]),p[2])