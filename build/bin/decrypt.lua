local function a(a)if a==nil then else term.write(a.."? [Y/n] ")end;local b=string.lower(string.sub(read(),1,1))if b=="y"or b=="j"or b==""then return true else return false end end;local function c(d,e)print(d)if not string.find(d,".crypt")then print("is already decrypted")if not a("Continue")then return end end;local f=io.open(d,"r")local g=f:read()local h=fs.open(string.gsub(d,".crypt",''),"w")while g do h.flush()f:flush()os.queueEvent("randomEvent")os.pullEvent()if g==nil or g:match("%S")==nil then h.writeLine()else local i=aes.decrypt(e,base64.decode(g),aes.AES256,aes.CBCMODE)if i then h.writeLine(i)else printError("Faild!")return end end;g=f:read()end;h.close()f:close()fs.delete(d)end;local function j(k,e)if fs.isDir(k)then for l,m in pairs(fs.list(k))do local n=k..'/'..m;if fs.isDir(n)then j(n,e)else c(n,e)end end else c(k,e)end end;local o={...}if#o<2 then print("Usage: decrypt <path> <passwd>")return end;j(shell.resolve(o[1]),o[2])