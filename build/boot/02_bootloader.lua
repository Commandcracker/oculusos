local a=os.pullEvent;os.pullEvent=os.pullEventRaw;os.startTimer(1)local b=3;local c,d=term.getSize()local e=false;local function f(g,h)local i=math.floor((c-string.len(h))/2)+1;term.setCursorPos(i,g)term.write(h)end;local function j(j,k)selected=0;if not fs.exists("/"..j)then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write(k.." not found starting: OculusOS")sleep(2)else if not fs.exists("/"..j.."/boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot on "..k.." not found starting: OculusOS")sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("/"..j.."/boot")term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot on "..k.." done ore crashed starting: OculusOS")sleep(2)end end end;local function l()local m=".:/bin:/rom/programs"if term.isColor()then m=m..":/rom/programs/advanced"end;if turtle then m=m..":/rom/programs/turtle"else m=m..":/rom/programs/rednet:/rom/programs/fun"if term.isColor()then m=m..":/rom/programs/fun/advanced"end end;if pocket then m=m..":/rom/programs/pocket"end;if commands then m=m..":/rom/programs/command"end;if http then m=m..":/rom/programs/http"end;shell.setPath(m)shell.setAlias("cls","clear")local function n(...)local o=table.pack(...)for p=1,1 do local q=o[p]if q~=nil then if type(q)=="function"then q={q}o[p]=q end;if type(q[1])~="function"then error(("Bad table entry #1 at argument #%d (expected function, got %s)"):format(p,type(q[1])),2)end;if q.many and p<o.n then error(("Unexpected 'many' field on argument #%d (should only occur on the last argument)"):format(p),2)end end end;return function(shell,r,s,t)local q=o[r]if not q then if r<=o.n then return end;q=o[o.n]if not q or not q.many then return end end;return q[1](shell,s,t,table.unpack(q,2))end end;local function u(shell,s)return fs.complete(s,shell.dir(),false,true)end;local function v(shell,s)return fs.complete(s,shell.dir(),true,false)end;local function w(shell,s,t,x)local y=fs.complete(s,shell.dir(),true,true)if x then for z=1,#y do local A=y[z]if A:sub(-1)~="/"then y[z]=A.." "end end end;return y end;shell.setCompletionFunction("bin/cat",n(v))shell.setCompletionFunction("bin/display",n(v))shell.setCompletionFunction("bin/less",n(v))shell.setCompletionFunction("bin/touch",n(v))shell.setCompletionFunction("bin/tree",n(u))shell.setCompletionFunction("bin/decrypt",n(w))shell.setCompletionFunction("bin/encrypt",n(w))local B="/lib/"local C=fs.list(B)print("Booting OculusOS...")print("Initalizing lib...")for D in pairs(C)do os.loadAPI(B..C[D])print("> "..B..C[D])end;sleep(1)end;local function E(F)f(F,'Use the keys "UP" and')f(F+1,'"DOWN" to mark an entry,')f(F+2,'"ENTER" to boot of the')f(F+3,"marked operating system.")end;local function G(F)f(F,'Use the keys "UP" and "DOWN" to mark an entry,')f(F+1,'"ENTER" to boot of the marked operating system.')end;local function H()local selected=1;local I=false;while true do if term.isColor()then term.setBackgroundColor(colors.blue)else term.setBackgroundColor(colors.gray)end;term.clear()f(2,"Oculus bootloader")local J={"OculusOS",os.version(),"Startup"}if not turtle and not pocket then local K={"Disk1","Disk2","Disk3","Disk4","Disk5"}for j in ipairs(K)do table.insert(J,K[j])end end;if turtle and I==false then else for p in ipairs(J)do term.setCursorPos(4,5+p)term.write(" "..J[p])if not turtle and not pocket and I==false and p==5 then break end end end;if not turtle or I==true then term.setCursorPos(4,selected+5)term.write("*")end;if pocket then E(12)if not I then f(18,"automatically")f(19,"executing in "..b.."s.")end else if turtle then if I then f(12,'Use "UP" and "DOWN" to mark an entry,')f(13,'Press "ENTER" to boot from the entry')else E(5)f(11,"The highlighted entry is")f(12,"automatically executed in "..b.."s.")end else if I then G(17)else G(14)f(17,"The highlighted entry is automatically")f(18,"executed in "..b.."s.")end end end;if not turtle and not pocket and not I then paintutils.drawBox(2,4,c-1,12,colors.white)else if turtle and not I then else paintutils.drawBox(2,4,c-1,7+#J,colors.white)end end;local L,M=os.pullEvent()if L=="timer"and I==false then b=b-1;os.startTimer(1)if b<0 then return selected end elseif L=="key"then if M==200 then I=true;selected=selected-1;if selected==0 then selected=#J end elseif M==208 then I=true;selected=selected+1;if#J<selected then selected=1 end elseif M==28 then return selected end end end end;term.clear()selected=H()os.pullEvent=a;if selected==2 then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;term.write(os.version())term.setCursorPos(1,2)e=true elseif selected==3 then if not fs.exists("boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot not found starting: "..os.version())sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("boot")sleep(2)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot done ore crashed: "..os.version())sleep(2)end elseif selected==4 then j("disk","Disk1")elseif selected==5 then j("disk2","Disk2")elseif selected==6 then j("disk3","Disk3")elseif selected==7 then j("disk4","Disk4")elseif selected==8 then j("disk5","Disk5")end;if not e then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)term.setTextColour(colors.white)l()term.clear()term.setCursorPos(1,1)shell.run("/bin/shell")if term.isColour()then term.setTextColour(colours.orange)end;print("Goodbye")term.setTextColour(colours.white)sleep(1)os.shutdown()end