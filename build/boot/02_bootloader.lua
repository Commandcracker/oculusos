local a=os.pullEvent;os.pullEvent=os.pullEventRaw;os.startTimer(1)local b=3;local c,d=term.getSize()local e=false;local function f(g,h)local i=math.floor((c-string.len(h))/2)+1;term.setCursorPos(i,g)term.write(h)end;local function j(j,k)selected=0;if not fs.exists("/"..j)then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write(k.." not found starting: OculusOS")sleep(2)else if not fs.exists("/"..j.."/boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot on "..k.." not found starting: OculusOS")sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("/"..j.."/boot")term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot on "..k.." done ore crashed starting: OculusOS")sleep(2)end end end;local function l()local m=".:/bin:/rom/programs"if term.isColor()then m=m..":/rom/programs/advanced"end;if turtle then m=m..":/rom/programs/turtle"else m=m..":/rom/programs/rednet:/rom/programs/fun"if term.isColor()then m=m..":/rom/programs/fun/advanced"end end;if pocket then m=m..":/rom/programs/pocket"end;if commands then m=m..":/rom/programs/command"end;if http then m=m..":/rom/programs/http"end;shell.setPath(m)shell.setAlias("cls","clear")local function n(...)local o=table.pack(...)for p=1,1 do local q=o[p]if q~=nil then if type(q)=="function"then q={q}o[p]=q end;if type(q[1])~="function"then error(("Bad table entry #1 at argument #%d (expected function, got %s)"):format(p,type(q[1])),2)end;if q.many and p<o.n then error(("Unexpected 'many' field on argument #%d (should only occur on the last argument)"):format(p),2)end end end;return function(shell,r,s,t)local q=o[r]if not q then if r<=o.n then return end;q=o[o.n]if not q or not q.many then return end end;return q[1](shell,s,t,table.unpack(q,2))end end;local function u(shell,s)return fs.complete(s,shell.dir(),false,true)end;local function v(shell,s)return fs.complete(s,shell.dir(),true,false)end;local function w(shell,s,t,x)local y=fs.complete(s,shell.dir(),true,true)if x then for z=1,#y do local A=y[z]if A:sub(-1)~="/"then y[z]=A.." "end end end;return y end;local function B(shell,s,t,C)if#t+1==C then local D=shell.getCompletionInfo()if s:sub(-1)~="/"and D[shell.resolveProgram(s)]then return{" "}else local y=shell.completeProgram(s)for z=1,#y do local E=y[z]if E:sub(-1)~="/"and D[shell.resolveProgram(s..E)]then y[z]=E.." "end end;return y end else local F=t[C]local G=shell.resolveProgram(F)if not G then return end;local H=shell.getCompletionInfo()[G]if not H then return end;return H.fnComplete(shell,#t-C+1,s,{F,table.unpack(t,C+1,#t)})end end;shell.setCompletionFunction("bin/cat",n(v))shell.setCompletionFunction("bin/display",n(v))shell.setCompletionFunction("bin/less",n(v))shell.setCompletionFunction("bin/touch",n(v))shell.setCompletionFunction("bin/tree",n(u))shell.setCompletionFunction("bin/decrypt",n(w))shell.setCompletionFunction("bin/encrypt",n(w))shell.setCompletionFunction("bin/shell",n({B,2,many=true}))shell.setCompletionFunction("bin/list",n(u))local I="/lib/"local J=fs.list(I)print("Booting OculusOS...")print("Initalizing lib...")for K in pairs(J)do os.loadAPI(I..J[K])print("> "..I..J[K])end;local L="/etc/pack/packages/pack/"local M=L.."pack-src/lib/pack"local N=L.."pack/lib/pack"if fs.exists(M)then dofile(M).loadPackages(shell)elseif fs.exists(N)then dofile(N).loadPackages(shell)end;sleep(1)end;local function O(P)f(P,'Use the keys "UP" and')f(P+1,'"DOWN" to mark an entry,')f(P+2,'"ENTER" to boot of the')f(P+3,"marked operating system.")end;local function Q(P)f(P,'Use the keys "UP" and "DOWN" to mark an entry,')f(P+1,'"ENTER" to boot of the marked operating system.')end;local function R()local selected=1;local S=false;while true do if term.isColor()then term.setBackgroundColor(colors.blue)else term.setBackgroundColor(colors.gray)end;term.clear()f(2,"Oculus bootloader")local T={"OculusOS",os.version(),"Startup"}if not turtle and not pocket then local U={"Disk1","Disk2","Disk3","Disk4","Disk5"}for j in ipairs(U)do table.insert(T,U[j])end end;if turtle and S==false then else for p in ipairs(T)do term.setCursorPos(4,5+p)term.write(" "..T[p])if not turtle and not pocket and S==false and p==5 then break end end end;if not turtle or S==true then term.setCursorPos(4,selected+5)term.write("*")end;if pocket then O(12)if not S then f(18,"automatically")f(19,"executing in "..b.."s.")end else if turtle then if S then f(12,'Use "UP" and "DOWN" to mark an entry,')f(13,'Press "ENTER" to boot from the entry')else O(5)f(11,"The highlighted entry is")f(12,"automatically executed in "..b.."s.")end else if S then Q(17)else Q(14)f(17,"The highlighted entry is automatically")f(18,"executed in "..b.."s.")end end end;if not turtle and not pocket and not S then paintutils.drawBox(2,4,c-1,12,colors.white)else if turtle and not S then else paintutils.drawBox(2,4,c-1,7+#T,colors.white)end end;local V,W=os.pullEvent()if V=="timer"and S==false then b=b-1;os.startTimer(1)if b<0 then return selected end elseif V=="key"then if W==200 then S=true;selected=selected-1;if selected==0 then selected=#T end elseif W==208 then S=true;selected=selected+1;if#T<selected then selected=1 end elseif W==28 then return selected end end end end;term.clear()selected=R()os.pullEvent=a;if selected==2 then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;term.write(os.version())term.setCursorPos(1,2)e=true elseif selected==3 then if not fs.exists("boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot not found starting: "..os.version())sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("boot")sleep(2)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot done ore crashed: "..os.version())sleep(2)end elseif selected==4 then j("disk","Disk1")elseif selected==5 then j("disk2","Disk2")elseif selected==6 then j("disk3","Disk3")elseif selected==7 then j("disk4","Disk4")elseif selected==8 then j("disk5","Disk5")end;if not e then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)term.setTextColour(colors.white)l()term.clear()term.setCursorPos(1,1)shell.run("/bin/shell")if term.isColour()then term.setTextColour(colours.orange)end;print("Goodbye")term.setTextColour(colours.white)sleep(1)os.shutdown()end