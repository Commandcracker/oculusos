local a=os.pullEvent;os.pullEvent=os.pullEventRaw;os.startTimer(1)local b=3;local c,d=term.getSize()local e=false;local function f(g,h)local i=math.floor((c-string.len(h))/2)+1;term.setCursorPos(i,g)term.write(h)end;local function j(j,k)selected=0;if not fs.exists("/"..j)then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write(k.." not found starting: OculusOS")sleep(2)else if not fs.exists("/"..j.."/boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot on "..k.." not found starting: OculusOS")sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("/"..j.."/boot")term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot on "..k.." done ore crashed starting: OculusOS")sleep(2)end end end;local function l()local m=".:/bin:/rom/programs"if term.isColor()then m=m..":/rom/programs/advanced"end;if turtle then m=m..":/rom/programs/turtle"else m=m..":/rom/programs/rednet:/rom/programs/fun"if term.isColor()then m=m..":/rom/programs/fun/advanced"end end;if pocket then m=m..":/rom/programs/pocket"end;if commands then m=m..":/rom/programs/command"end;if http then m=m..":/rom/programs/http"end;shell.setPath(m)shell.setAlias("cls","clear")local function n()local n=require"cc.shell.completion"shell.setCompletionFunction("oculusos/programs/cat",n.build(n.file))shell.setCompletionFunction("oculusos/programs/display",n.build(n.file))shell.setCompletionFunction("oculusos/programs/touch",n.build(n.file))shell.setCompletionFunction("oculusos/programs/tree",n.build(n.dir))shell.setCompletionFunction("oculusos/programs/decrypt",n.build(n.dirOrFile))shell.setCompletionFunction("oculusos/programs/encrypt",n.build(n.dirOrFile))end;pcall(n)local o="/lib/"local p=fs.list(o)print("Booting OculusOS...")print("Initalizing lib...")for q in pairs(p)do os.loadAPI(o..p[q])print("> "..o..p[q])end;sleep(1)end;local function r(s)f(s,'Use the keys "UP" and')f(s+1,'"DOWN" to mark an entry,')f(s+2,'"ENTER" to boot of the')f(s+3,"marked operating system.")end;local function t(s)f(s,'Use the keys "UP" and "DOWN" to mark an entry,')f(s+1,'"ENTER" to boot of the marked operating system.')end;local function u()local selected=1;local v=false;while true do if term.isColor()then term.setBackgroundColor(colors.blue)else term.setBackgroundColor(colors.gray)end;term.clear()f(2,"Oculus bootloader")local w={"OculusOS",os.version(),"Startup"}if not turtle and not pocket then local x={"Disk1","Disk2","Disk3","Disk4","Disk5"}for j in ipairs(x)do table.insert(w,x[j])end end;if turtle and v==false then else for y in ipairs(w)do term.setCursorPos(4,5+y)term.write(" "..w[y])if not turtle and not pocket and v==false and y==5 then break end end end;if not turtle or v==true then term.setCursorPos(4,selected+5)term.write("*")end;if pocket then r(12)if not v then f(18,"automatically")f(19,"executing in "..b.."s.")end else if turtle then if v then f(12,'Use "UP" and "DOWN" to mark an entry,')f(13,'Press "ENTER" to boot from the entry')else r(5)f(11,"The highlighted entry is")f(12,"automatically executed in "..b.."s.")end else if v then t(17)else t(14)f(17,"The highlighted entry is automatically")f(18,"executed in "..b.."s.")end end end;if not turtle and not pocket and not v then paintutils.drawBox(2,4,c-1,12,colors.white)else if turtle and not v then else paintutils.drawBox(2,4,c-1,7+#w,colors.white)end end;local z,A=os.pullEvent()if z=="timer"and v==false then b=b-1;os.startTimer(1)if b<0 then return selected end elseif z=="key"then if A==200 then v=true;selected=selected-1;if selected==0 then selected=#w end elseif A==208 then v=true;selected=selected+1;if#w<selected then selected=1 end elseif A==28 then return selected end end end end;term.clear()selected=u()os.pullEvent=a;if selected==2 then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;term.write(os.version())term.setCursorPos(1,2)e=true elseif selected==3 then if not fs.exists("boot")then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.red)end;term.write("Boot not found starting: "..os.version())sleep(2)else term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)shell.run("boot")sleep(2)term.clear()term.setCursorPos(1,1)if term.isColor()then term.setTextColor(colors.yellow)end;sleep(2)term.write("Boot done ore crashed: "..os.version())sleep(2)end elseif selected==4 then j("disk","Disk1")elseif selected==5 then j("disk2","Disk2")elseif selected==6 then j("disk3","Disk3")elseif selected==7 then j("disk4","Disk4")elseif selected==8 then j("disk5","Disk5")end;if not e then term.setBackgroundColor(colors.black)term.clear()term.setCursorPos(1,1)l()if fs.exists("/.shellrc")then pcall(shell.run("/.shellrc"))end;shell.run("/bin/shell")if term.isColour()then term.setTextColour(colours.orange)end;print("Goodbye")term.setTextColour(colours.white)sleep(1)os.shutdown()end